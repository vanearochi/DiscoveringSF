function initMap(){function e(e){var i=String.fromCharCode(65+a),r=e.name,n=new google.maps.Marker({position:t,map:map,icon:{path:"M0-48c-9.8 0-17.7 7.8-17.7 17.4 0 15.5 17.7 30.6 17.7 30.6s17.7-15.4 17.7-30.6c0-9.6-7.9-17.4-17.7-17.4z",fillColor:"#FF1010",fillOpacity:.7,strokeWeight:3,scale:.75,labelOrigin:new google.maps.Point(0,(-25))},title:r,id:a,label:{text:i,fontSize:"18px"},visible:!0});google.maps.event.addListener(n,"click",o),e.marker=n}function o(){markerSelected(this),hideMarkers(this),askInfoToPlacesLibrary(this),selectedStatus(!0)}var i;map=new google.maps.Map(document.getElementById("map"),{center:{lat:37.82,lng:-122.431297},zoom:12}),google.maps.event.addDomListener(window,"resize",function(){var e=map.getCenter();google.maps.event.trigger(map,"resize"),map.setCenter(e),map.setZoom(11)});for(var a=0;a<placesContainer().length;a++){var t=placesContainer()[a].location;e(placesContainer()[a])}askInfoToPlacesLibrary=function(e){function o(o,i){if(e.setAnimation(null),i==google.maps.places.PlacesServiceStatus.OK){var a=o[0],t=a.formatted_address;koAddress(""),koAddress(t)}}var i=e.title,a=new google.maps.places.PlacesService(map);a.textSearch({query:i},o),e.setAnimation(google.maps.Animation.BOUNCE)},showDirections=function(e){void 0!==i&&void 0!==i.map&&(i.setMap(null),i.setPanel(null));var o,a=e.coords.latitude,t=e.coords.longitude,r={lat:a,lng:t},n=new google.maps.DirectionsService;i=new google.maps.DirectionsRenderer,i.setMap(map),i.setPanel(document.getElementById("steps")),o=document.getElementById("travelMode").value;var l={origin:r,destination:markerSelected().position,travelMode:google.maps.TravelMode[o]};n.route(l,function(e,o){o==google.maps.DirectionsStatus.OK?(void 0!==userMarker&&userMarker.setVisible(!1),markerSelected().setVisible(!1),i.setDirections(e),loadingDirections(!1)):o==google.maps.DirectionsStatus.ZERO_RESULTS?(alert("No route could be found between the origin and destination. Please try another travel mode"),loadingDirections(!1)):(alert("Sorry there was an error:"+o),loadingDirections(!1))})},hideMarkers=function(e){map.setZoom(15),map.setCenter(e.position);for(var o=0;o<placesContainer().length;o++){var i=placesContainer()[o];i.marker!=e&&i.marker.setVisible(!1)}},showAllMarkers=function(){selectedStatus(!1),map.setZoom(12),map.setCenter({lat:37.82,lng:-122.431297}),void 0!==i&&(i.setMap(null),i.setPanel(null));for(var e=0;e<placesContainer().length;e++){var o=placesContainer()[e];o.marker.setVisible(!0)}},hideOrShowMarker=function(e,o){e.setVisible(o)},showUserLocation=function(e){var o=e.coords.latitude,i=e.coords.longitude,a=new google.maps.LatLng({lat:o,lng:i}),t=new google.maps.LatLng({lat:37.82,lng:-122.431297}),r=new google.maps.LatLngBounds;userMarker=new google.maps.Marker({position:a,icon:{path:"M0-48c-9.8 0-17.7 7.8-17.7 17.4 0 15.5 17.7 30.6 17.7 30.6s17.7-15.4 17.7-30.6c0-9.6-7.9-17.4-17.7-17.4z",fillColor:"#1569C7",fillOpacity:.7,strokeWeight:3,scale:.75,labelOrigin:new google.maps.Point(0,(-25))},visible:!0,zIndex:2}),selectedStatus()===!0?(r.extend(markerSelected().getPosition()),r.extend(a),map.fitBounds(r),userMarker.setMap(map)):(userMarker.setMap(map),r.extend(t),r.extend(a),map.fitBounds(r)),google.maps.event.addListener(map,"idle",function(){map.panBy(0,0)})}}function myViewModel(){var e=this;e.addressVisible=ko.observable(!1),e.infoVisible=ko.observable(!1),e.inputValue=ko.observable(""),e.placeAddress=ko.observable(""),e.wikiInfo=ko.observable(""),e.url=ko.observable(""),e.goToWikiPage=ko.observable("More Info"),e.showMyLocation=ko.observable(!0),e.selectedStatus=ko.observable(!1),e.showOrHideLocation=ko.observable("Show my location"),e.textValue=ko.observable("Show all places"),e.giveWikiInfo=function(e){var o=e.replace(/\s/g,"_");return wikiPromise=$.ajax({type:"get",url:"https://www.wikipedia.org/w/api.php?action=query&list=search&srsearch="+o+"_California&format=json&callback=wikiCallback",dataType:"jsonp",error:function(e){alert("Sorry there was an error: "+e.status+" "+e.statusText)}}),wikiPromise},e.passClickInformation=function(){askInfoToPlacesLibrary(this.marker),e.hideTitles(this.marker),markerSelected(this.marker),e.showWikiInfo(this.marker),e.infoVisible(!0),selectedStatus(!0)},e.hideTitles=function(e){hideMarkers(e);for(var o=0;o<placesContainer().length;o++)placesContainer()[o].marker!=e&&placesContainer()[o].titleVisible(!1)},e.showAllTitles=function(){loadingDirections===!0&&loadingDirections(!1),showAllMarkers(),e.infoVisible(!1),e.inputValue(""),e.wikiInfo("");for(var o=0;o<placesContainer().length;o++)placesContainer()[o].titleVisible(!0)},markerSelected.subscribe(function(o){e.hideTitles(o),"span"!=event.path[0].localName&&e.showWikiInfo(o)}),e.inputValue.subscribe(function(o){var i=o.trim();selectedStatus()===!0&&(showAllMarkers(),e.infoVisible(!1),selectedStatus(!1));for(var a=0;a<placesContainer().length;a++){var t=placesContainer()[a];i.length>0?t.name.toLowerCase().includes(i)===!0?(t.titleVisible(!0),hideOrShowMarker(t.marker,!0)):(t.titleVisible(!1),hideOrShowMarker(t.marker,!1)):(t.titleVisible(!0),hideOrShowMarker(t.marker,!0))}}),koAddress.subscribe(function(o){e.infoVisible(!0),e.placeAddress(o)}),e.showWikiInfo=function(o){wikiPromise=e.giveWikiInfo(o.title),wikiPromise.then(function(i){if(0===i.query.search.length)alert("Sorry we couldn't find any Wikipedia Information for the place you are looking for");else if(i.query.search.length>0){var a=i.query.search[0].snippet;e.wikiInfo(a);var t="https://en.wikipedia.org/wiki/"+o.title;e.url(t)}})},e.callGoogleDirections=function(){e.getGeolocation(showDirections),e.showOrHideLocation("Show my location"),loadingDirections(!0)},e.getUserLocation=function(){"Show my location"===e.showOrHideLocation()?(loadingCurrentLocation(!0),e.getGeolocation(showUserLocation)):(e.showOrHideLocation("Show my location"),console.log(userMarker),hideOrShowMarker(userMarker,!1))},e.getGeolocation=function(o){function i(i){loadingDirections()===!1&&e.showOrHideLocation("Hide my location"),o(i),loadingCurrentLocation(!1)}function a(e){alert("Sorry there was an error:"+e.code+" "+e.message)}if("geolocation"in navigator){var t=navigator.geolocation;t.getCurrentPosition(i,a)}else alert("Sorry geolocation is not available")}}var map,placesContainer=ko.observable([{name:"Golden Gate Bridge",location:{lat:37.8199286,lng:-122.47825510000001},titleVisible:ko.observable(!0)},{name:"Crissy Field",location:{lat:37.8039,lng:-122.4641},titleVisible:ko.observable(!0)},{name:"Golden Gate Park",location:{lat:37.7694208,lng:-122.48621379999997},titleVisible:ko.observable(!0)},{name:"Fort Point",location:{lat:37.8105931,lng:-122.4771093},titleVisible:ko.observable(!0)},{name:"Mount Davidson",location:{lat:37.73833330000001,lng:-122.4533333},titleVisible:ko.observable(!0)},{name:"San Francisco Ferry Building",location:{lat:37.7955469,lng:-122.39341769999999},titleVisible:ko.observable(!0)},{name:"San Francisco Symphony",location:{lat:37.777629,lng:-122.4906083},titleVisible:ko.observable(!0)},{name:"de Young Museum",location:{lat:37.7714732,lng:-122.4708642},titleVisible:ko.observable(!0)},{name:"Bay Bridge",location:{lat:37.7982799,lng:-122.377777},titleVisible:ko.observable(!0)},{name:"Alcatraz Island",location:{lat:37.8269775,lng:-122.4229555},titleVisible:ko.observable(!0)}]),abc=["A ","B ","C ","D ","E ","F ","G ","H ","I ","J "],markerSelected=ko.observable(""),koAddress=ko.observable(""),selectedStatus=ko.observable(!1),askInfoToPlacesLibrary,hideMarkers,showDirections,showAllMarkers,hideOrShowMarker,showUserLocation,userMarker,loadingCurrentLocation=ko.observable(!1),loadingDirections=ko.observable(!1);ko.applyBindings(new myViewModel);